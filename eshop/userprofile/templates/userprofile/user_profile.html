{% extends "shop/base.html" %}
{% block content %}
<h2>User Profile</h2>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-success">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <h3>Update Profile</h3>
    {{ u_form.as_p }}
    <br>
    <h3>Update Avatar</h3>
    <img src="{{ user.profile.avatar.url }}" alt="{{ user.username }}'s avatar" class="img-thumbnail" style="width: 150px; height: 150px;">
    {{ p_form.as_p }}
    <button type="submit" name="update_profile">Update Profile</button>
</form>

<a href="{% url 'password_change' %}">Change Password</a>

<form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <h3>Create Order</h3>
    {{ o_form.as_p }}
    <button type="submit" name="create_order">Create Order</button>
</form>

<h3>Your Orders</h3>
<table>
    <tr>
        <th>Image</th>
        <th>Description</th>
        <th>Proposed Price</th>
        <th>Delivery Address</th>
        <th>Actions</th>
    </tr>
    {% for order in orders %}
    <tr>
        <td><img src="{{ order.image.url }}" alt="Order Image" width="100"></td>
        <td>{{ order.description }}</td>
        <td>{{ order.proposed_price }}</td>
        <td>{{ order.delivery_address }}</td>
        <td>
            <a href="{% url 'edit_order' order.id %}">Edit</a> |
            <a href="{% url 'delete_order' order.id %}">Delete</a>
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}
